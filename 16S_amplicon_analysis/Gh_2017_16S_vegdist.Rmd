---
title: "Veg-Distance"
author: "Max Miao"
date: "July 18, 2019"
output: html_document
---


```{r}
knitr::opts_chunk$set(echo = TRUE)
library(vegan)
gh_soil16S = read.csv("ghsoil16S_1.csv", header = T)
bray = vegdist(gh_soil16S[,24:1229], method = "bray")
bray_matrix = as.matrix(bray)
bray_matrix = as.data.frame(bray_matrix)
a <- adonis(gh_soil16S[24:1229]~timepoint + Soil_type + Species + Species*Soil_type*timepoint, data = gh_soil16S, method = "bray", permutations = 999)
a
metadata = gh_soil16S[,0:23]
```

notice: timepoint:Species            0.034 * 

Now let's merge meta data with bray curtis matrix...

install_github("pmartinezarbizu/pairwiseAdonis/pairwiseAdonis")
pairwise adonis --> custom code found on github repository: "This is a wrapper function for multilevel pairwise comparison using adonis (~Permanova) from package 'vegan'. The function returns adjusted p-values using p.adjust(). It does not accept interaction between factors neither strata."


```{r}
library(tidyverse)
merged_col <- c(metadata,bray_matrix)
merged_col <- as.data.frame(merged_col)
write.csv(merged_col, "bray-curtis.csv")


#pairwise statistic for timepoint 2 and low nutrient
library(pairwiseAdonis)
pairwise.adonis(merged_col[,23:166],merged_col$Species)
```

Now we will conduct betadispersion test (Levene's test for homogeniety) sort of: 

```{r}
#need to know the ordering for each of the labels. We will group based on Timepoint and potato species. In order to do this:
groups <- 

betadisper(bray, )
```

